<!DOCTYPE html>
<html>
  <head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-125084205-2"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    
      gtag('config', 'UA-125084205-2');
    </script>

    <base target="_top">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <?!= HtmlService.createHtmlOutputFromFile('stylesheet').getContent(); ?>
  </head>
  <body>
  <?var url = getScriptUrl();?>
<form id="weekly_report" method="post" action=<?=url?>>
  <div id="space">
    <div class="msr_text_03">
      <h1 class="msr_h103">ゲツジェネ 1.0 Ver.KT </h1>
    </div>
    <div class="msr_text_03">
      <h4 class="msr_h403">> <a href="https://script.google.com/macros/s/AKfycbwI7Ye7jN-Fi82zHcXcLG80tDn7n8fcgcCWmiIRnlePe9PgN6Q1/exec">21ポータル</a></h4>
    </div>

    <div class="msr_pulldown_03">
      <h3 class="msr_h303">名前</h3>
      <select name="staff_select" id="staff_select">
        <!--<option value="">選択してください</option>-->
      </select>
    </div>
    <div class="msr_text_03">
      <h3 class="msr_h303">期間</h3>
      <input type="text" class="w120" id="start_date" name="start_date" readonly="readonly" /> - 
      <input type="text" class="w120" id="end_date" name="end_date" readonly="readonly" />
    </div>
    
    <div class="msr_text_03">
      <h3 class="msr_h303">■1．顧客名</h3>
      <input type="text" id="q1" name="q1" />
    </div>
    <div class="msr_text_03">
      <h3 class="msr_h303">■2．案件名</h3>
      <input type="text" id="q2" name="q2" />
    </div>
    <div class="msr_text_03">
      <h3 class="msr_h303">■3．場所(最寄駅)</h3>
      <input type="text" id="q3" name="q3" />
    </div>
    
    <div class="msr_chack_03">
      <h3 class="msr_h303">■4．今月実施した作業</h3>
      <input type="checkbox" name="q4" id="q4_01" value="企画・提案" />
      <label for="q4_01">企画・提案</label>
      <input type="checkbox" name="q4" id="q4_02" value="要件定義（要求定義）" />
      <label for="q4_02">要件定義（要求定義）</label>
      <input type="checkbox" name="q4" id="q4_03" value="外部設計（基本設計、概要設計）" />
      <label for="q4_03">外部設計（基本設計、概要設計）</label>
      <input type="checkbox" name="q4" id="q4_04" value="内部設計（詳細設計、機能設計）" />
      <label for="q4_04">内部設計（詳細設計、機能設計）</label>
      <input type="checkbox" name="q4" id="q4_05" value="製造・実装" />
      <label for="q4_05">製造・実装</label>
      <input type="checkbox" name="q4" id="q4_06" value="単体テスト" />
      <label for="q4_06">単体テスト</label>
      <input type="checkbox" name="q4" id="q4_07" value="結合テスト" />
      <label for="q4_07">結合テスト</label>
      <input type="checkbox" name="q4" id="q4_08" value="総合テスト" />
      <label for="q4_08">総合テスト</label>
      <input type="checkbox" name="q4" id="q4_09" value="システムテスト" />
      <label for="q4_09">システムテスト</label>
      <input type="checkbox" name="q4" id="q4_10" value="運用テスト" />
      <label for="q4_10">運用テスト</label>
      <input type="checkbox" name="q4" id="q4_11" value="運用・保守" />
      <label for="q4_11">運用・保守</label>
    </div>
    
    <div class="msr_chack_03">
      <h3 class="msr_h303">■5．今月使用したOS</h3>
      <input type="checkbox" name="q5" id="q5_01" value="Linux系" />
      <label for="q5_01">Linux系</label>
      <input type="checkbox" name="q5" id="q5_02" value="Mac" />
      <label for="q5_02">Mac</label>
      <input type="checkbox" name="q5" id="q5_03" value="Windows系" />
      <label for="q5_03">Windows系</label>
      <input type="checkbox" name="q5" id="q5_04" value="UNIX系" />
      <label for="q5_04">UNIX系</label>
      <input type="checkbox" name="q5" id="q5_05" value="汎用機" />
      <label for="q5_05">汎用機</label>
      <input type="checkbox" name="q5" id="q5_06" value="組み込み系" />
      <label for="q5_06">組み込み系</label>
      <input type="checkbox" name="q5" id="q5_07" value="iOS" />
      <label for="q5_07">iOS</label>
      <input type="checkbox" name="q5" id="q5_08" value="Android" />
      <label for="q5_08">Android</label>
      <input type="checkbox" name="q5" id="q5_09" value="Firefox" />
      <label for="q5_09">Firefox</label>
    </div>
    
  
    <div class="msr_chack_03">
      <h3 class="msr_h303">■6．今月使用したプログラム言語</h3>
      <input type="checkbox" name="q6" id="q6_01" value="ABAP" />
      <label for="q6_01">ABAP</label>
      <input type="checkbox" name="q6" id="q6_02" value="ASP .NET" />
      <label for="q6_02">ASP .NET</label>
      <input type="checkbox" name="q6" id="q6_03" value="C" />
      <label for="q6_03">C</label>
      <input type="checkbox" name="q6" id="q6_04" value="C++" />
      <label for="q6_04">C++</label>
      <input type="checkbox" name="q6" id="q6_05" value="C# .NET" />
      <label for="q6_05">C# .NET</label>
      <input type="checkbox" name="q6" id="q6_06" value="COBOL" />
      <label for="q6_06">COBOL</label>
      <input type="checkbox" name="q6" id="q6_07" value="Delphi" />
      <label for="q6_07">Delphi</label>
      <input type="checkbox" name="q6" id="q6_08" value="HTML" />
      <label for="q6_08">HTML</label>
      <input type="checkbox" name="q6" id="q6_09" value="Java" />
      <label for="q6_09">Java</label>
      <input type="checkbox" name="q6" id="q6_10" value="JavaScript" />
      <label for="q6_10">JavaScript</label>
      <input type="checkbox" name="q6" id="q6_11" value="Perl" />
      <label for="q6_11">Perl</label>
      <input type="checkbox" name="q6" id="q6_12" value="PHP" />
      <label for="q6_12">PHP</label>
      <input type="checkbox" name="q6" id="q6_13" value="PL/1" />
      <label for="q6_13">PL/1</label>
      <input type="checkbox" name="q6" id="q6_14" value="PL/SQL" />
      <label for="q6_14">PL/SQL</label>
      <input type="checkbox" name="q6" id="q6_15" value="RPG" />
      <label for="q6_15">RPG</label>
      <input type="checkbox" name="q6" id="q6_16" value="Shell" />
      <label for="q6_16">Shell</label>
      <input type="checkbox" name="q6" id="q6_17" value="SQL" />
      <label for="q6_17">SQL</label>
      <input type="checkbox" name="q6" id="q6_18" value="VBA" />
      <label for="q6_18">VBA</label>
      <input type="checkbox" name="q6" id="q6_19" value="VB" />
      <label for="q6_19">VB</label>
      <input type="checkbox" name="q6" id="q6_20" value="VB.NET" />
      <label for="q6_20">VB.NET</label>
      <input type="checkbox" name="q6" id="q6_21" value="ASP" />
      <label for="q6_21">ASP</label>
      <input type="checkbox" name="q6" id="q6_22" value="VC・VC++" />
      <label for="q6_22">VC・VC++</label>
      <input type="checkbox" name="q6" id="q6_23" value="Ruby" />
      <label for="q6_23">Ruby</label>
      <input type="checkbox" name="q6" id="q6_24" value="ActionScript" />
      <label for="q6_24">ActionScript</label>
      <input type="checkbox" name="q6" id="q6_25" value="HTML5" />
      <label for="q6_25">HTML5</label>
      <input type="checkbox" name="q6" id="q6_26" value="Python" />
      <label for="q6_26">Python</label>
      <input type="checkbox" name="q6" id="q6_27" value="Objective-C" />
      <label for="q6_27">Objective-C</label>
      <input type="checkbox" name="q6" id="q6_28" value="Scala" />
      <label for="q6_28">Scala</label>
      <input type="checkbox" name="q6" id="q6_29" value="Ajax" />
      <label for="q6_29">Ajax</label>
      <input type="checkbox" name="q6" id="q6_30" value="jQuery" />
      <label for="q6_30">jQuery</label>
      <input type="checkbox" name="q6" id="q6_31" value="F#" />
      <label for="q6_31">F#</label>
      <input type="checkbox" name="q6" id="q6_32" value="Haskell" />
      <label for="q6_32">Haskell</label>
      <input type="checkbox" name="q6" id="q6_33" value="R" />
      <label for="q6_33">R</label>
      <input type="checkbox" name="q6" id="q6_34" value="Swift" />
      <label for="q6_34">Swift</label>
      <input type="checkbox" name="q6" id="q6_35" value="CSS" />
      <label for="q6_35">CSS</label>
      <input type="checkbox" name="q6" id="q6_36" value="BAT" />
      <label for="q6_36">BAT</label>
      <input type="checkbox" name="q6" id="q6_37" value="Go" />
      <label for="q6_37">Go</label>
      <input type="checkbox" name="q6" id="q6_38" value="Unity" />
      <label for="q6_38">Unity</label>
      <input type="checkbox" name="q6" id="q6_39" value="Cocos2d-x" />
      <label for="q6_39">Cocos2d-x</label>
    </div>
    
  
    <div class="msr_chack_03">
      <h3 class="msr_h303">■7．今月使用したDB</h3>
      <input type="checkbox" name="q7" id="q7_01" value="MySQL" /><label for="q7_01">MySQL</label>
      <input type="checkbox" name="q7" id="q7_02" value="PostgreSQL" /><label for="q7_02">PostgreSQL</label>
      <input type="checkbox" name="q7" id="q7_03" value="SQLite" /><label for="q7_03">SQLite</label>
      <input type="checkbox" name="q7" id="q7_04" value="Oracle DB" /><label for="q7_04">Oracle DB</label>
      <input type="checkbox" name="q7" id="q7_05" value="SQL Server" /><label for="q7_05">SQL Server</label>
      <input type="checkbox" name="q7" id="q7_06" value="DB2" /><label for="q7_06">DB2</label>
      <input type="checkbox" name="q7" id="q7_07" value="H2 Database" /><label for="q7_07">H2 Database</label>
      <input type="checkbox" name="q7" id="q7_08" value="Apache Derby" /><label for="q7_08">Apache Derby</label>
      <input type="checkbox" name="q7" id="q7_09" value="Apache Cassandra" /><label for="q7_09">Apache Cassandra</label>
      <input type="checkbox" name="q7" id="q7_10" value="Apache CouchDB" /><label for="q7_10">Apache CouchDB</label>
      <input type="checkbox" name="q7" id="q7_11" value="Apache HBase" /><label for="q7_11">Apache HBase</label>
      <input type="checkbox" name="q7" id="q7_12" value="ArangoDB" /><label for="q7_12">ArangoDB</label>
      <input type="checkbox" name="q7" id="q7_13" value="Basho Riak" /><label for="q7_13">Basho Riak</label>
      <input type="checkbox" name="q7" id="q7_14" value="Chordless" /><label for="q7_14">Chordless</label>
      <input type="checkbox" name="q7" id="q7_15" value="Db4o" /><label for="q7_15">Db4o</label>
      <input type="checkbox" name="q7" id="q7_16" value="Hibari" /><label for="q7_16">Hibari</label>
      <input type="checkbox" name="q7" id="q7_17" value="Hypertable" /><label for="q7_17">Hypertable</label>
      <input type="checkbox" name="q7" id="q7_18" value="Memcachedb" /><label for="q7_18">Memcachedb</label>
      <input type="checkbox" name="q7" id="q7_19" value="Mnesia" /><label for="q7_19">Mnesia</label>
      <input type="checkbox" name="q7" id="q7_20" value="MongoDB" /><label for="q7_20">MongoDB</label>
      <input type="checkbox" name="q7" id="q7_21" value="okuyama" /><label for="q7_21">okuyama</label>
      <input type="checkbox" name="q7" id="q7_22" value="Project Voldemort" /><label for="q7_22">Project Voldemort</label>
      <input type="checkbox" name="q7" id="q7_23" value="Redis" /><label for="q7_23">Redis</label>
      <input type="checkbox" name="q7" id="q7_24" value="SimpleDB" /><label for="q7_24">SimpleDB</label>
      <input type="checkbox" name="q7" id="q7_25" value="Neo4j" /><label for="q7_25">Neo4j</label>
      <input type="checkbox" name="q7" id="q7_26" value="DEX" /><label for="q7_26">DEX</label>
      <input type="checkbox" name="q7" id="q7_27" value="BaseX" /><label for="q7_27">BaseX</label>
      <input type="checkbox" name="q7" id="q7_28" value="eXist" /><label for="q7_28">eXist</label>
      <input type="checkbox" name="q7" id="q7_29" value="AllegroGraph" /><label for="q7_29">AllegroGraph</label>
      <input type="checkbox" name="q7" id="q7_30" value="OrientDB" /><label for="q7_30">OrientDB</label>
      <input type="checkbox" name="q7" id="q7_31" value="InfiniteGraph" /><label for="q7_31">InfiniteGraph</label>
      <input type="checkbox" name="q7" id="q7_32" value="Sones GraphDB" /><label for="q7_32">Sones GraphDB</label>
      <input type="checkbox" name="q7" id="q7_33" value="InfoGrid" /><label for="q7_33">InfoGrid</label>
      <input type="checkbox" name="q7" id="q7_34" value="HyperGraphDB" /><label for="q7_34">HyperGraphDB</label>
    </div>
    
    <div class="msr_textarea_03">
      <h3 class="msr_h303">■8. 今月使用したツール(自由記入)</h3>
        <textarea id="q8" name="q8"></textarea>
    </div>
    
    <div class="msr_pulldown_03">
      <h3 class="msr_h303">■9. 現在の案件に満足していますか？</h3>
      <select name="q9">
        <option value="満足">満足</option>
        <option value="やや満足">やや満足</option>
        <option value="普通" selected>普通</option>
        <option value="やや不満足">やや不満足</option>
        <option value="不満足">不満足</option>
      </select>
    </div>
    
    <div class="msr_textarea_03">
      <h3 class="msr_h303">■10. 相談したいこと・困っていること<br />(自由記入)</h3>
        <textarea id="q10" name="q10"></textarea>
    </div>
    <p class="msr_sendbtn_03">
      <input type="submit" value="出力">
    </p>
  </div>
</form>

<?!= HtmlService.createHtmlOutputFromFile('javascript').getContent(); ?>
    <script>
      $(function() {
      
        var q4 = '';
        var q5 = '';
        var q6 = '';
        var q7 = '';
        
        // =====================
        // 社員選択セレクトボックスの項目追加
        // =====================
        
        var staff_select = $.cookie('staff_select');
        
        var select = document.getElementById("staff_select");
        var staffs = { data: JSON.parse(<?= data ?>) };
        console.log(staffs);
        for(var i=0;i<staffs.data.length;i++){
        
          option = document.createElement('option');
          option.setAttribute('value', i);
          if (staffs.data[i].name == staff_select) { 
            option.setAttribute('selected', 'selected');
          }
          option.innerHTML = staffs.data[i].name;
          select.add(option);
          
        }
        
        if ($.cookie('start_date')) {
          $("#start_date").val($.cookie('start_date'));
        }
        if ($.cookie('end_date')) {
          $("#end_date").val($.cookie('end_date'));
        }
        
        if ($.cookie('q4')) q4 = $.cookie('q4');
        if ($.cookie('q5')) q5 = $.cookie('q5');
        if ($.cookie('q6')) q6 = $.cookie('q6');
        if ($.cookie('q7')) q7 = $.cookie('q7');
        if ($.cookie('q9')) q9 = $.cookie('q9');
        
        
        $('[name="q4"]').map(function(){
          if (q4.indexOf( $(this).val() ) !== -1) {
            $(this).attr('checked', 'checked');
          }
        });
        
        $('[name="q5"]').map(function(){
          if (q5.indexOf( $(this).val() ) !== -1) {
            $(this).attr('checked', 'checked');
          }
        });
        
        $('[name="q6"]').map(function(){
          if (q6.indexOf( $(this).val() ) !== -1) {
            $(this).attr('checked', 'checked');
          }
        });
        
        $('[name="q7"]').map(function(){
          if (q7.indexOf( $(this).val() ) !== -1) {
            $(this).attr('checked', 'checked');
          }
        });

        $("#q1").val($.cookie('q1'));
        $("#q2").val($.cookie('q2'));
        $("#q3").val($.cookie('q3'));
        $("#q8").text($.cookie('q8'));
        
        $('select[name="q9"] option').each(function() {
          if (q9.indexOf( $(this).val() ) !== -1) {
            $(this).attr('selected', 'selected');
          }
        });
        
        $("#q10").text($.cookie('q10'));
        //console.log(staffs.data[0].name);
      });
    </script>
  </body>
</html>


